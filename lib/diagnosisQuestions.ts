/**
 * 진단/사후 검사 문항 기본 구조 (6개 역량, 역량당 5문항).
 * 학교별로 관리자가 수정 시 API에서 덮어쓴 값을 사용한다.
 */

export type DiagnosisDomainConfig = {
  name: string;
  items: string[];
};

export const DEFAULT_DIAGNOSIS_DOMAINS: DiagnosisDomainConfig[] = [
  {
    name: "수업 설계·운영",
    items: [
      "학습 목표를 학생 수준에 맞게 구체적 행동 목표로 제시한다.",
      "성취기준과 수업 활동이 일관되게 연결되도록 수업을 설계한다.",
      "학생 참여를 높이기 위해 질문, 토의, 활동을 균형 있게 운영한다.",
      "수업 중 학생 반응에 따라 설명·활동을 조정(즉각적 수정)한다.",
      "다양한 교수·학습 자료(교구/매체/실물 등)를 목적에 맞게 선택·활용한다.",
    ],
  },
  {
    name: "학생 이해·생활지도",
    items: [
      "학생의 발달 특성(인지·정서·사회성)을 고려하여 지도한다.",
      "학생의 강점과 어려움을 파악하기 위해 관찰·대화·기록을 지속한다.",
      "문제행동을 다룰 때 원인(상황/욕구)을 먼저 파악하고 지도한다.",
      "갈등 상황에서 학생이 감정을 조절하고 관계를 회복하도록 돕는다.",
      "학생의 다양성(가정·문화·개별차)을 존중하며 차별 없이 지도한다.",
    ],
  },
  {
    name: "평가·피드백",
    items: [
      "평가 계획을 수업 목표와 연계하여 사전에 안내한다.",
      "수행평가에서 평가기준(루브릭 등)을 명확히 제시한다.",
      "학생의 학습 과정을 평가에 반영하기 위해 형성평가를 활용한다.",
      "피드백을 \"잘함/보완점/다음 전략\"처럼 구체적으로 제공한다.",
      "평가 결과를 다음 수업 개선과 개별 지도에 실제로 반영한다.",
    ],
  },
  {
    name: "학급경영·안전",
    items: [
      "학급 규칙과 기대 행동을 학생과 함께 정하고 일관되게 적용한다.",
      "수업 전환(활동 이동, 정리, 모둠 전환 등)을 효율적으로 운영한다.",
      "교실 환경(자리 배치, 자료 동선 등)을 학습에 도움이 되게 구성한다.",
      "안전사고 예방을 위해 위험요소를 점검하고 예방지도를 실시한다.",
      "위기 상황(사고·응급·폭력·재난 등) 발생 시 절차에 따라 침착하게 대응한다.",
    ],
  },
  {
    name: "전문성 개발·성찰",
    items: [
      "수업 후 성찰(기록/회고)을 통해 개선점을 구체화한다.",
      "학생 학습자료, 평가 결과 등을 근거로 수업을 점검·개선한다.",
      "연수·독서·연구회 등으로 새로운 교수법을 지속적으로 학습한다.",
      "동료의 수업을 관찰하거나 피드백을 주고받으며 공동 성장한다.",
      "교육 정책/지침 변화가 수업과 학급 운영에 미치는 영향을 파악하고 반영한다.",
    ],
  },
  {
    name: "소통·협력 및 포용적 교육",
    items: [
      "학부모와의 소통에서 학생의 강점과 성장 중심으로 신뢰를 형성한다.",
      "민감한 사안(생활/평가/갈등)을 전달할 때 사실·근거·대안을 갖추어 설명한다.",
      "담임·전담·특수/상담 등과 협력하여 학생 지원을 연계한다.",
      "학습에 어려움이 있는 학생을 위해 지원(조정, 보조자료, 추가 지도)을 계획적으로 제공한다.",
      "교실에서 모든 학생이 참여할 수 있도록 포용적 활동(역할, 수준, 참여 방식)을 설계한다.",
    ],
  },
];

export type Question = { id: string; text: string; domain: string };

/** domains(6개 역량, 각 5문항)를 진단 페이지에서 쓰는 Question[] 형태로 변환 */
export function domainsToQuestions(domains: DiagnosisDomainConfig[]): Question[] {
  if (!Array.isArray(domains) || domains.length !== 6) return [];
  const out: Question[] = [];
  const domainKeys = ["domain1", "domain2", "domain3", "domain4", "domain5", "domain6"];
  domains.forEach((d, di) => {
    const items = Array.isArray(d.items) ? d.items : [];
    for (let i = 0; i < 5; i++) {
      out.push({
        id: String(di * 5 + i + 1),
        text: (items[i] ?? "").trim() || `문항 ${di * 5 + i + 1}`,
        domain: domainKeys[di] ?? `domain${di + 1}`,
      });
    }
  });
  return out;
}
